<app-header></app-header>

<section class="p-6 max-w-5xl mx-auto">
  <h2 class="text-2xl font-semibold mb-6 text-slate-900 dark:text-slate-100">Artículos del usuario</h2>

  <a routerLink="/createarticle" class="m-5 inline-block bg-blue-700 p-2 rounded-md hover:bg-blue-800 text-white">
    Crear Articulo
    </a>
  <div *ngIf="loading" class="text-center py-12 text-slate-600 dark:text-slate-300">Cargando...</div>

  <!-- grid de cards -->
  <div *ngIf="!loading && articles.length" class="grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3">
    <article *ngFor="let a of articles" class="rounded-2xl border border-slate-200 bg-white p-4 shadow-sm hover:shadow-md transition-shadow dark:border-slate-700 dark:bg-slate-900">
      <div class="flex items-start gap-3 mb-3">
        <img *ngIf="a.user?.avatar" [src]="'/uploads/avatars/' + a.user.avatar" alt="avatar" class="w-12 h-12 rounded-full object-cover">
        <div>
          <h3 class="text-lg font-semibold text-slate-900 dark:text-slate-100">{{ a.title }}</h3>
          <p class="text-sm text-slate-500 dark:text-slate-400"> {{ a.user?.nick }}</p>
        </div>
      </div>

      <p class="text-sm text-slate-700 dark:text-slate-300 mb-4">
        {{ a.content ? (a.content | slice:0:140) + '…' : (a.summary ?? '') }}
      </p>

      <div class="flex items-center justify-between text-sm">
        <time class="text-slate-500 dark:text-slate-400">{{ a.created_at || a.createdAt | date:'mediumDate' }}</time>
        <a [routerLink]="['/article', a._id]" class="text-primary-600 hover:underline dark:text-primary-400">Ver artículo</a>
      </div>
    </article>
  </div>

  <!-- mensaje si no hay articulos -->
  <div *ngIf="!loading && articles.length === 0" class="text-center py-12 text-slate-600 dark:text-slate-300">
    No hay artículos.
  </div>

  <!-- paginacion -->
  <div *ngIf="!loading && total > itemsPerPage" class="flex items-center justify-center gap-3 mt-8">
    <button (click)="prev()" [disabled]="page === 1"
      class="px-4 py-2 rounded-lg border bg-white text-slate-700 hover:bg-slate-50 disabled:opacity-50 dark:bg-slate-800 dark:border-slate-700 dark:text-slate-200">
      Anterior
    </button>
    <span class="px-3 py-1 text-sm text-slate-700 dark:text-slate-300"></span>
    <button (click)="next()" [disabled]="page * itemsPerPage >= total"
      class="px-4 py-2 rounded-lg border bg-white text-slate-700 hover:bg-slate-50 disabled:opacity-50 dark:bg-slate-800 dark:border-slate-700 dark:text-slate-200">
      Siguiente
    </button>
  </div>
</section>

<app-footer></app-footer>